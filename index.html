<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Diplomat’s Lounge</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Inline favicon (avoids GH Pages 404s) -->
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%230058ff'/%3E%3Ctext x='16' y='21' text-anchor='middle' font-family='Arial' font-size='16' fill='white'%3EDL%3C/text%3E%3C/svg%3E">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700;800&display=swap" rel="stylesheet">

  <!-- Leaflet (mini-maps) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="anonymous">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin="anonymous"></script>

  <!-- Firebase (optional; fill config below to enable multiplayer) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore-compat.js"></script>
  <script>
    /* ===== Fill this to enable multiplayer; leave as {} for solo mode =====
       Get values from Firebase console -> Project settings -> General
    */
    window.FIREBASE_CONFIG = {
      /* example:
      apiKey: "...",
      authDomain: "...",
      projectId: "...",
      appId: "..."
      */
    };
  </script>

  <style>
    :root{
      --bg:#ffffff; --ink:#0f1720; --muted:#5b6472;
      --blue:#055aff; --blue-2:#3b82f6; --good:#079455; --bad:#e11d48;
      --ring:#e8edf4; --shadow:rgba(16,24,40,.08);
      --stage-max: 980px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--ink);
      font-family:"Inter",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      display:flex; flex-direction:column; align-items:center;
    }

    /* ——— Header: tiny, neutral ——— */
    header{
      width:100%; max-width:var(--stage-max);
      padding:18px 16px 8px; display:flex; gap:12px; align-items:center; justify-content:space-between;
    }
    .brand{font-weight:800; letter-spacing:.06em}
    .pill{display:inline-flex; align-items:center; gap:8px; border:1px solid var(--ring); border-radius:999px; padding:8px 12px; box-shadow:0 3px 10px var(--shadow)}
    .pill small{color:var(--muted); font-weight:700}
    .btn{border:1px solid var(--ring); border-radius:10px; padding:10px 14px; font-weight:800; cursor:pointer; background:#f6faff}
    .btn.primary{background:var(--blue); color:#fff; border-color:var(--blue)}
    .btn:disabled{opacity:.55; cursor:not-allowed}

    /* ——— Center “Google simple” stage ——— */
    main{ width:100%; max-width:var(--stage-max); padding:12px 16px 28px; display:flex; flex-direction:column; align-items:center; gap:18px }

    /* Responsive stage with the sofa as centerpiece */
    .stage{ width:min(100%, 900px); position:relative; aspect-ratio: 3 / 2; border-radius:22px; overflow:hidden }
    .stage img{ width:100%; height:100%; object-fit:cover; display:block; filter: saturate(1.02) }

    /* Face overlay SVG sits on top, scales with the image via viewBox */
    .faces{ position:absolute; inset:0; pointer-events:none }

    /* Speech bubbles (minimal) */
    .bubble{
      position:absolute; padding:6px 10px; border-radius:10px; background:#111827; color:#fff;
      font-size:12px; font-weight:700; opacity:0; transform:translate(-50%,-8px); transition:opacity .16s ease, transform .16s ease;
      white-space:nowrap; pointer-events:none;
    }
    .bubble.show{ opacity:1; transform:translate(-50%,-14px) }
    #bubK{ left:24%; top:24% }   /* tweak if needed */
    #bubC{ left:76%; top:24% }

    /* Controls cluster (simple like a search bar) */
    .controls{
      display:flex; gap:8px; flex-wrap:wrap; justify-content:center;
      border:1px solid var(--ring); border-radius:999px; padding:8px;
      box-shadow:0 8px 24px var(--shadow); background:#fff;
    }
    .ctl{display:flex; align-items:center; gap:8px}
    .ctl input[type="text"], .ctl input[type="number"]{
      width:92px; padding:10px 12px; border-radius:999px; border:1px solid var(--ring); text-align:center; font-weight:800
    }
    .toggle{display:flex; gap:6px; align-items:center; font-weight:700; color:var(--muted)}
    .bankRow{ display:flex; gap:12px; justify-content:center; align-items:center; font-weight:800 }
    .you{ color:var(--good) } .opp{ color:var(--bad) }

    /* Cards (mini maps) */
    .arena{ width:100%; display:grid; grid-template-columns:1fr 1fr; gap:14px }
    .card{ border:1px solid var(--ring); background:#fff; border-radius:16px; padding:12px; box-shadow:0 8px 24px var(--shadow) }
    .line{ font-weight:800; letter-spacing:.04em }
    .eta{ color:var(--muted); font-weight:700; font-size:13px }
    .progress{ margin-top:10px; height:12px; background:#f3f6fb; border:1px solid var(--ring); border-radius:999px; overflow:hidden }
    .bar{ height:100%; width:0%; background:linear-gradient(90deg,#19a0ff,#a8eaff) }
    .map{ margin-top:10px; height:180px; border-radius:12px; overflow:hidden; border:1px solid var(--ring) }
    .log{ text-align:center; font-weight:800; border:1px solid var(--ring); background:#fff; border-radius:14px; padding:12px; box-shadow:0 8px 24px var(--shadow) }

    @media (max-width:860px){
      .arena{ grid-template-columns:1fr }
    }

    /* ——— Face animation primitives ——— */
    .eye{ transition: transform .12s ease }
    .blink{ transform: scaleY(0.05) }                    /* blink state */
    .mouth{ transform-origin:50% 50%; transition: transform .08s ease }
    .talk{ animation: talk .22s ease-in-out infinite }   /* chatter */
    @keyframes talk { 0%{ transform:scaleY(0.7) } 50%{ transform:scaleY(1.25) } 100%{ transform:scaleY(0.9) } }
    .smile{ d:path("M -20 0 Q 0 14 20 0"); }             /* for <path> via CSS 'd' is not standard, so we switch classes in JS */

    /* (We’ll swap whole <path> data in JS for smile/frown) */
  </style>
</head>
<body>
  <header>
    <div class="brand">Diplomat’s Lounge</div>
    <div class="pill" id="seatPill" title="Your seat">Seat: <strong id="seatName">Solo</strong></div>
    <div style="display:flex; gap:8px">
      <button id="newRoom" class="btn">New room</button>
      <button id="copyLink" class="btn">Copy invite</button>
    </div>
  </header>

  <main>
    <!-- Centerpiece stage -->
    <div class="stage" id="stage">
      <img src="./sofawithkesslerandcajun.png" alt="Kessler and the Cajun on a sofa" />

      <!-- Speech bubbles -->
      <div class="bubble" id="bubK"></div>
      <div class="bubble" id="bubC"></div>

      <!-- Overlay SVG (viewBox matches PNG proportions so everything scales) -->
      <svg class="faces" viewBox="0 0 1152 768" preserveAspectRatio="none">
        <!-- Kessler face (approx positions tuned to the provided image) -->
        <g id="K" transform="translate(330, 305)">
          <!-- eyes (left/right) -->
          <ellipse id="K_eyeL" class="eye" cx="-30" cy="0" rx="11" ry="11" fill="#1b2230"/>
          <ellipse id="K_eyeR" class="eye" cx="30" cy="0" rx="11" ry="11" fill="#1b2230"/>
          <!-- mouth as a rounded rect we scale for “talk”; we will also swap to a <path> smile/frown on reactions -->
          <rect id="K_mouth" class="mouth" x="-22" y="38" width="44" height="14" rx="7" fill="#1b2230"/>
        </g>

        <!-- Cajun face -->
        <g id="C" transform="translate(830, 295)">
          <ellipse id="C_eyeL" class="eye" cx="-28" cy="0" rx="11" ry="11" fill="#1b2230"/>
          <ellipse id="C_eyeR" class="eye" cx="28" cy="0" rx="11" ry="11" fill="#1b2230"/>
          <rect id="C_mouth" class="mouth" x="-22" y="38" width="44" height="14" rx="7" fill="#1b2230"/>
        </g>
      </svg>
    </div>

    <!-- Minimal control bar -->
    <div class="controls">
      <div class="ctl">
        <div class="toggle"><label><input id="liveToggle" type="checkbox"> LIVE</label></div>
        <input id="airport" type="text" maxlength="4" value="JFK" placeholder="IATA" />
      </div>
      <div class="ctl"><span>Bet</span><input id="betIn" type="number" value="50" step="25" min="25" /></div>
      <div class="ctl"><button id="deal" class="btn primary">Deal flights</button></div>
      <div class="ctl"><button id="reset" class="btn">Reset bank</button></div>
    </div>

    <div class="bankRow">
      <span>Kessler: <span id="bankK" class="you">500 sirignanos</span></span>
      <span>·</span>
      <span>Cajun: <span id="bankC" class="opp">2,000 sirignanos</span></span>
    </div>

    <!-- Round / maps -->
    <div class="arena">
      <div class="card" id="A">
        <div class="line" id="lineA">A — waiting…</div>
        <div class="eta" id="etaA"></div>
        <div class="progress"><div class="bar" id="barA"></div></div>
        <div class="map" id="mapA"></div>
      </div>
      <div class="card" id="B">
        <div class="line" id="lineB">B — waiting…</div>
        <div class="eta" id="etaB"></div>
        <div class="progress"><div class="bar" id="barB"></div></div>
        <div class="map" id="mapB"></div>
      </div>
      <div class="log" id="log">Welcome to the Diplomat’s Lounge. Deal flights to start.</div>
    </div>
  </main>

  <script src="./game.js"></script>
</body>
</html>
